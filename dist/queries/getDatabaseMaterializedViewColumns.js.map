{"version":3,"sources":["../../src/queries/getDatabaseMaterializedViewColumns.js"],"names":["connection","any","sql"],"mappings":";;;;;;AAEA;;;;;+BAQe,WAAOA,UAAP,EAA+F;AAC5G,WAAOA,WAAWC,GAAX,CAAeC,aAAI;;;;;;;;;;;;;;;GAAnB,CAAP;AAgBD,G","file":"getDatabaseMaterializedViewColumns.js","sourcesContent":["// @flow\n\nimport {\n  sql\n} from 'mightyql';\nimport type {\n  DatabaseConnectionType,\n  UnnormalizedColumnType\n} from '../types';\n\nexport default async (connection: DatabaseConnectionType): Promise<$ReadOnlyArray<UnnormalizedColumnType>> => {\n  return connection.any(sql`\n    SELECT\n      mv.relname AS \"tableName\",\n      atr.attname AS \"columnName\",\n      pg_catalog.format_type (atr.atttypid, NULL) \"dataType\",\n      (case when atr.attnotnull then 'YES' else 'NO' end) \"isNullable\"\n    FROM\n      pg_class mv\n      JOIN pg_namespace ns ON mv.relnamespace = ns.oid\n      JOIN pg_attribute atr ON atr.attrelid = mv.oid\n      AND atr.attnum > 0\n      AND NOT atr.attisdropped\n    WHERE\n      ns.nspname = 'public' AND\n      mv.relkind = 'm'\n  `);\n};\n"]}